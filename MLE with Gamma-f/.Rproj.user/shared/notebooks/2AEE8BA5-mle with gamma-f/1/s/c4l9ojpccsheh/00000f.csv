"0",""
"0","sample_mean <- mean(sim_data)"
"0","sample_var <- var(sim_data)"
"0",""
"0","# this are the  sample correspondents of the expressions above giving the parameters in terms of the moments"
"0","start_shape <- sample_mean^2 / sample_var"
"0","start_rate <- sample_mean / sample_var"
"0",""
"0","start_params <- c(start_shape, start_rate)"
"0",""
"0","# Perform the optimization"
"0","mle_optim_rate <- optim("
"0","  par = start_params,"
"0","  fn = neg_log_likelihood_rate,"
"0","  data = sim_data,"
"0","  hessian = TRUE"
"0",")"
"0",""
"0","# Extract the ML estimates"
"0","mle_params_rate <- mle_optim_rate$par"
"0","names(mle_params_rate) <- c(""Shape (lambda)"", ""Rate (alpha)"")"
