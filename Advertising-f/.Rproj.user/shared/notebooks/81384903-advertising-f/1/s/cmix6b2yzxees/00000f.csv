"0","# This named vector is the single source of truth for all block colors."
"0","summary_colors <- c("
"0","  block1 = ""#e6f0ff"",  # Light blue for ""Call"""
"0","  block2 = ""#e6ffe6"",  # Light green for ""Residuals"""
"0","  block3 = ""#fff5e6"",  # Light orange for ""Coefficients"""
"0","  block4 = ""#f9e6ff""   # Light purple for ""Model Fit"""
"0",")"
"0","#Helper functions"
"0",""
"0","# FUNCTION A: Prints the full, 4-block summary with colors"
"0","summary_with_colors <- function(model) {"
"0","  summary_text <- capture.output(summary(model))"
"0","  call_start <- grep(""^Call:"", summary_text)"
"0","  residuals_start <- grep(""^Residuals:"", summary_text)"
"0","  coeffs_start <- grep(""^Coefficients:"", summary_text)"
"0","  footer_start <- grep(""^Residual standard error:"", summary_text)"
"0","  "
"0","  block1_text <- summary_text[call_start:(residuals_start - 1)]"
"0","  block2_text <- summary_text[residuals_start:(coeffs_start - 1)]"
"0","  block3_text <- summary_text[coeffs_start:(footer_start - 1)]"
"0","  block4_text <- summary_text[footer_start:length(summary_text)]"
"0","  "
"0","  wrap_in_div <- function(text, color) {"
"0","    text_collapsed <- paste(text, collapse = ""\n"")"
"0","    sprintf("
"0","      '<div style=""background-color: %s; border: 1px solid #ddd; border-radius: 5px; padding: 10px; margin-bottom: 10px;""><pre style=""margin: 0;"">%s</pre></div>',"
"0","      color,"
"0","      htmltools::htmlEscape(text_collapsed)"
"0","    )"
"0","  }"
"0","  "
"0","  html_output <- paste("
"0","    wrap_in_div(block1_text, summary_colors[""block1""]),"
"0","    wrap_in_div(block2_text, summary_colors[""block2""]),"
"0","    wrap_in_div(block3_text, summary_colors[""block3""]),"
"0","    wrap_in_div(block4_text, summary_colors[""block4""]),"
"0","    sep = ""\n"""
"0","  )"
"0","  asis_output(html_output)"
"0","}"
"0","# FUNCTION B: Highlights inline text with a block's color"
"0","highlight_block_text <- function(text, block_number) {"
"0","  color <- summary_colors[block_number]"
"0","  sprintf("
"0","    '<span style=""background-color: %s; padding: 2px 5px; border-radius: 4px; font-family: monospace;"">%s</span>',"
"0","    color,"
"0","    text"
"0","  )"
"0","}"
"0","# FUNCTION C: Prints a single, isolated block of the summary"
"0","print_summary_block <- function(model, block_number) {"
"0","  if (!(block_number %in% 1:4)) {"
"0","    stop(""Invalid block_number. Please choose a number from 1 to 4."")"
"0","  }"
"0","  "
"0","summary_text <- capture.output(summary(model))"
"0","  call_start <- grep(""^Call:"", summary_text)"
"0","  residuals_start <- grep(""^Residuals:"", summary_text)"
"0","  coeffs_start <- grep(""^Coefficients:"", summary_text)"
"0","  footer_start <- grep(""^Residual standard error:"", summary_text)"
"0","  "
"0","  all_blocks <- list("
"0","    ""1"" = summary_text[call_start:(residuals_start - 1)],"
"0","    ""2"" = summary_text[residuals_start:(coeffs_start - 1)],"
"0","    ""3"" = summary_text[coeffs_start:(footer_start - 1)],"
"0","    ""4"" = summary_text[footer_start:length(summary_text)]"
"0","  )"
"0","  "
"0","  selected_text <- all_blocks[[as.character(block_number)]]"
"0","  selected_color <- summary_colors[block_number]"
"0","  "
"0","  text_collapsed <- paste(selected_text, collapse = ""\n"")"
"0","  html_output <- sprintf("
"0","      '<div style=""background-color: %s; border: 1px solid #ddd; border-radius: 5px; padding: 10px;""><pre style=""margin: 0;"">%s</pre></div>',"
"0","      selected_color,"
"0","      htmltools::htmlEscape(text_collapsed)"
"0","  )"
"0","  asis_output(html_output)"
"0","}"
