knitr::opts_chunk$set(echo = TRUE)
#building a function for computing a t-interval
ci_sd <- function(y, alpha = 0.05) {
# sample size and mean
m     <- length(y) # as before
meany <- mean(y) # as before
# sample standard deviation
sd_hat_2 <- sd(y) # as before
#
scr_sd <- \sqrt(m-1) * sd_hat_2
#building a function for computing a t-interval
ci_sd <- function(y, alpha = 0.05) {
# sample size and mean
m     <- length(y) # as before
meany <- mean(y) # as before
# sample standard deviation
sd_hat_2 <- sd(y) # as before
#
scr_sd <- sqrt(m-1) * sd_hat_2
# chi critical values
tcrit_low <- sqrt(qchisq(0.025,df=m-1))
tcrit_upper <- sqrt(qchisq(0.9755,df=m-1))
# interval endpoints
chi_lower <- scr_sd / tcrit_upper
chi_upper <- scr_sd / tcrit_lower
# return as a list
return(list(
m        = m,
mean     = meany,
sd_hat   = sd_hat_2,
scr       = scr_sd,
# t_crit   = tcrit,
lower    = chi_lower,
upper    = chi_upper
))
}
#building a function for computing a t-interval
ci_sd <- function(y, alpha = 0.05) {
# sample size and mean
m     <- length(y) # as before
meany <- mean(y) # as before
# sample standard deviation
sd_hat_2 <- sd(y) # as before
#
scr_sd <- sqrt(m-1) * sd_hat_2
# chi critical values
tcrit_low <- sqrt(qchisq(alpha/2,df=m-1))
tcrit_upper <- sqrt(qchisq(1-alpha/2,df=m-1))
# interval endpoints
chi_lower <- scr_sd / tcrit_upper
chi_upper <- scr_sd / tcrit_lower
# return as a list
return(list(
m        = m,
mean     = meany,
sd_hat   = sd_hat_2,
scr       = scr_sd,
# t_crit   = tcrit,
lower    = chi_lower,
upper    = chi_upper
))
}
ci_sd_95 <- ci_sd(y,0.05)
y <- dados_2$difference
chi_ci_table <- data.frame(
Method        = c("chi-interval for sigma""),
# SD_or_sigma   = round(c(ci_unknown_2$sd_hat, ci_est$sd_hat), 4),
#SE            = round(c(ci_unknown_2$se, ci_est$se_hat), 4),
#CriticalValue = round(c(z_crit, t_crit), 4),
CI_Lower      = round(c(ci_sd_95$lower), 4),
Mean          = round(c(ci_sd_95$mean), 4),
CI_Upper      = round(c(ci_sd_95$upper), 4)
)
knitr::kable(chi_ci_table, caption = "Confidence Intervals for sigma")
chi_ci_table <- data.frame(
Method        = c("chi-interval for sigma""),
# SD_or_sigma   = round(c(ci_unknown_2$sd_hat, ci_est$sd_hat), 4),
#SE            = round(c(ci_unknown_2$se, ci_est$se_hat), 4),
#CriticalValue = round(c(z_crit, t_crit), 4),
CI_Lower      = round(c(ci_sd_95$lower), 4),
Mean          = round(c(ci_sd_95$mean), 4),
CI_Upper      = round(c(ci_sd_95$upper), 4)
)
knitr::kable(chi_ci_table, caption = "Confidence Intervals for Sigma")
chi_ci_table <- data.frame(
Method        = c("chi-interval for sigma""),
# SD_or_sigma   = round(c(ci_unknown_2$sd_hat, ci_est$sd_hat), 4),
#SE            = round(c(ci_unknown_2$se, ci_est$se_hat), 4),
#CriticalValue = round(c(z_crit, t_crit), 4),
CI_Lower      = round(c(ci_sd_95$lower), 4),
Mean          = round(c(ci_sd_95$mean), 4),
CI_Upper      = round(c(ci_sd_95$upper), 4)
)
knitr::kable(chi_ci_table, caption = "Confidence Interval")
chi_ci_table <- data.frame(
Method        = c("chi-interval for sigma""),
# SD_or_sigma   = round(c(ci_unknown_2$sd_hat, ci_est$sd_hat), 4),
#SE            = round(c(ci_unknown_2$se, ci_est$se_hat), 4),
#CriticalValue = round(c(z_crit, t_crit), 4),
CI_Lower      = round(c(ci_sd_95$lower), 4),
Mean          = round(c(ci_sd_95$mean), 4),
CI_Upper      = round(c(ci_sd_95$upper), 4)
)
knitr::kable(chi_ci_table, caption = "A")
chi_ci_table <- data.frame(
Method        = c("chi-interval for sigma""),
# SD_or_sigma   = round(c(ci_unknown_2$sd_hat, ci_est$sd_hat), 4),
#SE            = round(c(ci_unknown_2$se, ci_est$se_hat), 4),
#CriticalValue = round(c(z_crit, t_crit), 4),
CI_Lower      = round(c(ci_sd_95$lower), 4),
Mean          = round(c(ci_sd_95$mean), 4),
CI_Upper      = round(c(ci_sd_95$upper), 4)
)
knitr::kable(chi_ci_table)
chi_ci_table <- data.frame(
Method        = c("chi-interval for sigma),
# SD_or_sigma   = round(c(ci_unknown_2$sd_hat, ci_est$sd_hat), 4),
#SE            = round(c(ci_unknown_2$se, ci_est$se_hat), 4),
#CriticalValue = round(c(z_crit, t_crit), 4),
CI_Lower      = round(c(ci_sd_95$lower), 4),
Mean          = round(c(ci_sd_95$mean), 4),
CI_Upper      = round(c(ci_sd_95$upper), 4)
)
knitr::kable(chi_ci_table,"A")
chi_ci_table <- data.frame(
Method        = c("chi-interval for sigma"),
# SD_or_sigma   = round(c(ci_unknown_2$sd_hat, ci_est$sd_hat), 4),
#SE            = round(c(ci_unknown_2$se, ci_est$se_hat), 4),
#CriticalValue = round(c(z_crit, t_crit), 4),
CI_Lower      = round(c(ci_sd_95$lower), 4),
Mean          = round(c(ci_sd_95$mean), 4),
CI_Upper      = round(c(ci_sd_95$upper), 4)
)
chi_ci_table <- data.frame(
Method        = c("chi-interval for sigma"),
CI_Lower      = round(c(ci_sd_95$lower), 4),
Mean          = round(c(ci_sd_95$mean), 4),
CI_Upper      = round(c(ci_sd_95$upper), 4)
)
ci_sd_95 <- ci_sd(y,0.05)
knitr::opts_chunk$set(echo = TRUE)
dados <- read.csv("coal.csv")
str(dados)
print(dados)
x <- dados$measurement
length(x)
summary(x)
#building a function for computing a z-interval (known sigma)
ci_mean_known_sigma <- function(x, sigma, alpha = 0.05) {
# sample size and mean
n     <- length(x)
meanx <- mean(x)
# standard error under known sigma
se <- sigma / sqrt(n)
# normal critical value
zcrit <- qnorm(1 - alpha/2)
# margin of error
margin <- zcrit * se
# interval endpoints
lower <- meanx - margin
upper <- meanx + margin
# return as a list
return(list(
n        = n,
mean     = meanx,
se       = se,
z_crit   = zcrit,
lower    = lower,
upper    = upper
))
}
# saving the evaluated function
ci_known_coal_90 <- ci_mean_known_sigma(x,0.1,0.1) # 90%
ci_known_coal <- ci_mean_known_sigma(x,0.1,0.05) # 95% (the standard choice)
ci_known_coal_98 <- ci_mean_known_sigma(x,0.1,0.02) # 98%
str(ci_known_coal)
ci_table_coal <- data.frame(
Method        = c("z-interval (known sigma at 90%)","z-interval (known sigma at 95%)","z-interval (known sigma at 98%)"),
# SD_or_sigma   = round(c(sigma_known, sd_hat), 4),
#SE            = round(c(se_known, se_hat), 4),
#CriticalValue = round(c(z_crit, t_crit), 4),
CI_Lower      = round(c(ci_known_coal_90$lower,ci_known_coal$lower,ci_known_coal_98$lower), 4),
Mean          = round(c(ci_known_coal_90$mean,ci_known_coal$mean,ci_known_coal_98$mean), 4),
CI_Upper      = round(c(ci_known_coal_90$upper,ci_known_coal$upper,ci_known_coal_98$upper), 4)
)
knitr::kable(ci_table_coal, caption = "Confidence Interval for the Coal Problem (known sigma)")
dados_2 <- read.csv("races.csv")
str(dados_2)
head(dados_2)
y <- dados_2$difference
length(y)
summary(y)
#building a function for computing a t-interval
ci_mean_unknown_sigma_2 <- function(y, alpha = 0.05) {
# sample size and mean
m     <- length(y)
meany <- mean(y)
# sample standard deviation
sd_hat_2 <- sd(y)
# standard error
se_2 <- sd_hat_2 / sqrt(m)
# Student t critical value
tcrit <- qt(1 - alpha/2, df = m - 1)
# margin of error
margin <- tcrit * se_2
# interval endpoints
lower <- meany - margin
upper <- meany + margin
# return as a list
return(list(
m        = m,
mean     = meany,
sd_hat   = sd_hat_2,
se       = se_2,
t_crit   = tcrit,
lower    = lower,
upper    = upper
))
}
#saving the evaluated function
ci_unknown_2_95 <- ci_mean_unknown_sigma_2(y,0.05) # 95% (the standard choice)
ci_unknown_2_98 <- ci_mean_unknown_sigma_2(y,0.02) # 98%
ci_table_skates <- data.frame(
Method        = c("t-interval for races (unknown sigma at 95%)", "t-interval for races (unknown sigma at 98%)"),
SD_or_sigma   = round(c(ci_unknown_2_95$sd_hat,ci_unknown_2_98$sd_hat), 4),
#SE            = round(c(se_known, se_hat), 4),
#CriticalValue = round(c(z_crit, t_crit), 4),
CI_Lower      = round(c(ci_unknown_2_95$lower,ci_unknown_2_98$lower), 4),
Mean          = round(c(ci_unknown_2_95$mean,ci_unknown_2_98$mean), 4),
CI_Upper      = round(c(ci_unknown_2_95$upper,ci_unknown_2_98$upper), 4)
)
knitr::kable(ci_table_skates, caption = "Confidence Interval for races (unknown sigma)")
ci_est<-ci_mean_known_sigma(y,1.78,0.05)
print(ci_est)
ci_table_comp <- data.frame(
Method        = c("t-interval (unknown sigma)",
"z-interval (estimated sigma)"),
# SD_or_sigma   = round(c(ci_unknown_2$sd_hat, ci_est$sd_hat), 4),
#SE            = round(c(ci_unknown_2$se, ci_est$se_hat), 4),
#CriticalValue = round(c(z_crit, t_crit), 4),
CI_Lower      = round(c(ci_unknown_2_95$lower, ci_est$lower), 4),
Mean          = round(c(ci_unknown_2_95$mean, ci_est$mean), 4),
CI_Upper      = round(c(ci_unknown_2_95$upper, ci_est$upper), 4)
)
knitr::kable(ci_table_comp, caption = "Comparison of Confidence Intervals for races (unknown and estimated sigma)")
y <- dados_2$difference
length(y)
#building a function for computing a t-interval
ci_sd <- function(y, alpha = 0.05) {
# sample size and mean
m     <- length(y) # as before
meany <- mean(y) # as before
# sample standard deviation
sd_hat_2 <- sd(y) # as before
#
scr_sd <- sqrt(m-1) * sd_hat_2
# chi critical values
tcrit_lower <- sqrt(qchisq(alpha/2,df=m-1))
tcrit_upper <- sqrt(qchisq(1-alpha/2,df=m-1))
# interval endpoints
chi_lower <- scr_sd / tcrit_upper
chi_upper <- scr_sd / tcrit_lower
# return as a list
return(list(
m        = m,
mean     = meany,
sd_hat   = sd_hat_2,
# scr       = scr_sd,
# t_crit   = tcrit,
lower    = chi_lower,
upper    = chi_upper
))
}
ci_sd_95 <- ci_sd(y,0.05)
print(ci_sd_95)
chi_ci_table <- data.frame(
Method        = c("chi-interval for sigma"),
CI_Lower      = round(c(ci_sd_95$lower), 4),
Mean          = round(c(ci_sd_95$mean), 4),
CI_Upper      = round(c(ci_sd_95$upper), 4)
)
knitr::kable(chi_ci_table,"A")
chi_ci_table <- data.frame(
Method        = c("chi-interval for sigma"),
CI_Lower      = round(c(ci_sd_95$lower), 4),
Mean          = round(c(ci_sd_95$mean), 4),
CI_Upper      = round(c(ci_sd_95$upper), 4)
)
knitr::kable(chi_ci_table,caption = "A")
